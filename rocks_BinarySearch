min_distance = 1
    max_distance = distance
    rocks.sort()
    rocks = [0] + rocks + [distance]
    end_point = len(rocks)-1
    
    while min_distance < max_distance : 
        mid_distance = (min_distance + max_distance) // 2
        if mid_distance == min_distance : return min_distance
        removable_rocks = n
        start = 0
        idx = 1
        small_exist=False
        while True :
            if idx >= end_point : break
            if rocks[idx]-rocks[start] >= mid_distance : 
                start+=1
                idx+=1
            elif rocks[idx]-rocks[start] < mid_distance : 
                small_exist = True
                for i in range(1, removable_rocks+1) :
                    if idx+i > end_point : break
                    if rocks[idx+i] - rocks[start] >= mid_distance :
                        start = idx+i
                        idx = start+1
                        small_exist = False
                        removable_rocks -= i
                        break
                    else : pass
                if small_exist : 
                    break
                
        if small_exist : 
            max_distance = mid_distance-1
        else : 
            min_distance = mid_distance
                    
            
    return min_distance
    
    
    #2 
    points = rocks.copy()
    heapq.heapify(points)
    heapq.heappush(points, 0)
    heapq.heappush(points, distance)
    
    distances = []
    while len(points) != 1 :
        distances.append(-heapq.heappop(points)+points[0])
    
    min_distances = []
    for i, d in enumerate(distances) :
        #heapq.heappush(min_distances,(d,i))
        min_distances.append((d,i))
    
    removable_rocks = n
    min_distances = sorted(min_distances, key=lambda x : x[0])
    while removable_rocks :
        #idx = heapq.heappop(min_distances)[1]
        idx = min_distances.pop(0)[1]
        distances[idx+1] += distances[idx]
        distances[idx] = 1000000001
        removable_rocks-=1

        
    return min(distances)
    
